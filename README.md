Multi-Label Song Lyric Emotion ClassifierThis repository contains a deep learning project designed to classify song lyrics into multiple emotional categories. The models leverage advanced neural network architectures, including Bidirectional GRU with Bahdanau Attention and a BERT-based XLSTM model, to capture nuanced emotional cues from text.FeaturesMulti-Label Classification: Assigns multiple relevant emotion labels to a single song lyric.Advanced Architectures: Implements a Bi-directional Gated Recurrent Unit (BiGRU) network with a custom Bahdanau Attention mechanism for sequence understanding, and a BERT-based model for leveraging pre-trained language understanding.Robust Preprocessing: Includes custom text cleaning, tokenization, and sequence padding.Hyperparameter Tuning & Regularization: Utilizes L2 regularization, Dropout, Early Stopping, and Learning Rate Reduction on Plateau to enhance model performance and prevent overfitting.Comprehensive Evaluation: Evaluates models using Macro-averaged F1-score, Precision, and Recall.Emotional LabelsThe model classifies lyrics across the following emotional categories:hopejoyangerobsessionlustfear/tensiontendersadProject Structureconfig.py: Centralized configuration for hyperparameters, file paths, and model choices.data_handler.py: Functions for loading, cleaning, tokenizing, padding, and splitting data. Includes BERT embedding generation.model_architectures.py: Defines the custom Attention layer and the BiGRU-Attention and BERT-XLSTM model architectures.main_train.py: The main script to train and evaluate the selected deep learning model.predict_emotion.py: A utility script to make predictions on new song lyrics using a trained model.utils.py: Contains helper functions, such as plotting training history.requirements.txt: Lists all necessary Python dependencies.README.md: This file, providing an overview of the project.SetupClone the repository:git clone https://github.com/your-username/your-repo-name.git
cd your-repo-name
Create a virtual environment (recommended):python -m venv venv
source venv/bin/activate # On Windows: `venv\Scripts\activate`
Install dependencies:pip install -r requirements.txt
Data:Place your dataset (mydataset2900.xlsx) in a location accessible by the scripts. Update the FILE_PATH in config.py if it's not in the expected /kaggle/input/songlyricsdata/ (or relative path if placed directly in the repo).UsageTraining a ModelYou can choose between the BiGRU_Attention model or the BERT_XLSTM model by modifying the MODEL_TYPE variable in config.py.To train the model:python main_train.py
The trained model and tokenizer (for BiGRU) will be saved in the directory specified by MODEL_SAVE_PATH and TOKENIZER_SAVE_PATH in config.py.Making PredictionsAfter training, you can use the predict_emotion.py script to classify new lyrics.python predict_emotion.py
This script includes an example usage. Modify the sample_lyrics variable to test with your own text.Evaluation MetricsThe models are evaluated using:Macro-averaged F1-score: A balanced metric that considers both precision and recall across all labels.Precision (threshold 0.5): The proportion of correctly predicted positive labels out of all positive predictions.Recall (threshold 0.5): The proportion of correctly predicted positive labels out of all actual positive labels.
